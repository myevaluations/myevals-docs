---
title: "MyEvaluations.Business.TimeSheet"
description: "Auto-generated documentation for the MyEvaluations.Business.TimeSheet module"
sidebar_label: "TimeSheet"
tags: [dotnet, business-layer]
---

{/* Auto-generated by ai-enrich-dotnet.ts on 2026-02-20T16:00:00.000Z */}

## Overview

The TimeSheet module is a large, feature-rich business layer component (52 classes) responsible for managing resident and trainee duty-hour time tracking within MyEvaluations. It integrates with multiple external scheduling systems -- Amion, QGenda, and Tangier -- to import rotation schedules, on-call assignments, clinic shifts, and cross-cover duties. The module provides time sheet initialization, search, save, and violation-tracking workflows, along with CSV import capabilities and HTTP utilities for API communication. An audit logging system tracks external API interactions via SQL stored procedures.

## Key Classes

- **AmionManager** (extends Manager): The primary manager class orchestrating Amion scheduling integration. Serves as the central coordinator for importing and synchronizing schedule data from the Amion external scheduling platform.
- **AmionBase / AmionBaseAssignment**: Base classes forming an inheritance hierarchy for all Amion-related schedule entities and their assignments. AmionBase is extended by AmionClinic, AmionCrossCover, AmionOnCallSchedule, AmionShiftSchedule, AmionRotation, AmionUser, AmionClinicService, AmionOnCallService, and AmionRotationService.
- **AmionAPIService** (static): Handles HTTP communication with the Amion external API, including tracked HTTP clients, New Relic logging, payload utilities, and SQL-based API audit logging.
- **SqlApiAuditLogger** (static): Persists API response audit records to the database via the `usp_InsertApiResponseAudit` stored procedure.
- **QGendaAPI**: Integration client for the QGenda physician scheduling platform, providing an alternative scheduling data source.
- **TangierServiceModel** and related classes (tangier, tangierSchedule, tangierScheduleDatesDate, tangierScheduleDatesDateShiftsShift, tangierLocationsLocation, NewDataSet): XML/SOAP service model classes for the Tangier scheduling system integration via Web References.
- **BaseRequest / InitializeRequest / SearchRequest / SaveRequest / ExplanationRequest**: Request hierarchy for time sheet operations including initialization, searching (implements ICloneable), saving entries, and providing duty-hour explanations.
- **TimeSheetViolation**: Represents duty-hour violations detected during time sheet review, critical for ACGME compliance tracking.
- **ActivityInfo / ActivitySettingInfo / ActivityTypeInfo / SubActivityInfo**: Info classes describing time sheet activities, their settings, types, and sub-activities.
- **RotationInfo**: Data transfer object for rotation schedule information.
- **CSVReader**: Utility class for parsing CSV-formatted schedule import files.
- **HttpUtil**: HTTP utility class for web request handling.
- **Constants**: Module-wide constant definitions.
- **AmionScheduleTempTable / AmionScheduleLastUpdateDate**: Temporary table models and tracking for schedule synchronization timestamps.
- **ScheduleRequest** (TangierSchedule namespace, extends SoapHttpClientProtocol): SOAP web service proxy for Tangier schedule data retrieval.

## Patterns

- **Manager/Info pattern detected**: AmionManager extends the base Manager class, coordinating business logic. Multiple Info classes (ActivityInfo, ActivitySettingInfo, ActivityTypeInfo, RotationInfo, SubActivityInfo) serve as lightweight data transfer objects.
- **Inheritance hierarchy**: AmionBase serves as a base class for six Amion entity types; AmionBaseAssignment serves as a base for their corresponding assignment classes. BaseRequest forms a request hierarchy with four specialized request types.
- **External API integration**: Three separate scheduling platform integrations (Amion via REST API, QGenda via API, Tangier via SOAP Web References) following an adapter-like pattern.
- **Static utility classes**: AmionAPIService, HttpTrackedClient, NewRelicApiLogger, PayloadUtils, and SqlApiAuditLogger are static helper classes for cross-cutting concerns.
- **Audit logging**: API interactions are logged to SQL Server via stored procedures for compliance and debugging.

## Notes

- This is one of the largest modules in the business layer with 52 classes, indicating significant complexity in duty-hour tracking and schedule integration.
- The module depends on three external scheduling platforms (Amion, QGenda, Tangier), making it a key integration point. Migration to NestJS would require replicating these external API integrations.
- The SOAP-based Tangier integration (Web References) is a legacy pattern that would benefit from modernization during migration.
- The `usp_InsertApiResponseAudit` stored procedure is the only detected sproc; the AmionManager likely delegates further database operations to other modules or uses inline queries.
- Duty-hour violation tracking (TimeSheetViolation) is critical for ACGME/GME compliance and must be preserved during any migration effort.
- The ICloneable implementation on SearchRequest suggests complex search state management that may need careful translation.

---
*This documentation was auto-generated from source code analysis. Last updated: 2026-02-20T16:00:00.000Z*
