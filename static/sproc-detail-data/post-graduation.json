{"module":"POST","displayName":"Post-Graduation","procedureCount":2,"procedures":[{"name":"UpdateInboxDeliveryActiveStatus","schema":"dbo","parameters":[{"name":"@InboxDeliveryIDs","dataType":"LargeText","direction":"IN","defaultValue":null}],"lineCount":5,"tablesReferenced":["POST_InboxDelivery"],"sprocsCalledFromBody":[],"crudType":"update","antiPatterns":{"hasCursor":false,"hasSelectStar":false,"hasDynamicSql":false,"hasNolock":false,"nolockCount":0,"missingSetNocountOn":true,"hasTableVariable":false,"hasTempTable":false,"hasWhileLoop":false,"hasNoTryCatch":true},"calledFromCode":[],"complexity":"trivial","aiEnrichment":null,"module":"POST","summary":"Bulk-activates or deactivates inbox delivery records by setting their DeactivatedDate to NULL (active) or the current timestamp (deactivated) for a comma-delimited list of InboxDeliveryIDs. Uses IIF to toggle the soft-delete timestamp in a single UPDATE statement.","businessPurpose":"Supports the MyEvaluations messaging/notification inbox by enabling administrators or the application layer to activate or deactivate multiple inbox delivery entries at once — for example, when archiving delivered notifications, disabling stale inbox items, or restoring previously deactivated messages for residents or faculty.","optimizationRecommendations":["Replace the comma-delimited @InboxDeliveryIDs string parameter with a Table-Valued Parameter (TVP) of type UNIQUEIDENTIFIER to eliminate the STRING_SPLIT + CAST overhead and enable the query optimizer to use index seeks on InboxDeliveryID.","Add a covering index on POST_InboxDelivery (InboxDeliveryID) INCLUDE (DeactivatedDate) if one does not already exist, since every call performs a filtered update on this column.","Validate that STRING_SPLIT is available (SQL Server 2016+ compatibility level 130+); if older compatibility levels are in use, the function silently fails — prefer an explicit compatibility-level check or TVP migration.","Consider adding a WHERE clause guard (e.g., WHERE DeactivatedDate IS NULL AND @Active = 0 OR DeactivatedDate IS NOT NULL AND @Active = 1) to avoid issuing a write when no state change is needed, reducing unnecessary log writes."],"migrationRelevance":"medium"},{"name":"UpdateInboxDeliveryReadStatus","schema":"dbo","parameters":[{"name":"@InboxDeliveryIDs","dataType":"LargeText","direction":"IN","defaultValue":null}],"lineCount":5,"tablesReferenced":["POST_InboxDelivery"],"sprocsCalledFromBody":[],"crudType":"update","antiPatterns":{"hasCursor":false,"hasSelectStar":false,"hasDynamicSql":false,"hasNolock":false,"nolockCount":0,"missingSetNocountOn":true,"hasTableVariable":false,"hasTempTable":false,"hasWhileLoop":false,"hasNoTryCatch":true},"calledFromCode":[],"complexity":"trivial","aiEnrichment":null,"module":"POST","summary":"Bulk-marks inbox delivery records as read (ReadDate = GETDATE()) or unread (ReadDate = NULL) for a comma-delimited list of InboxDeliveryIDs. The @Read parameter defaults to 1 (mark-read) when NULL is passed, via ISNULL(@Read, 1).","businessPurpose":"Tracks whether residents, faculty, or program coordinators have read their inbox notifications within the MyEvaluations platform. Called when a user opens or dismisses messages, enabling unread-count badges, read-receipt tracking, and inbox filtering by read status.","optimizationRecommendations":["Replace the comma-delimited @InboxDeliveryIDs string parameter with a Table-Valued Parameter (TVP) of type UNIQUEIDENTIFIER to eliminate STRING_SPLIT + CAST overhead and allow index-based lookups.","The ISNULL(@Read, 1) default is implicit and not obvious to callers — document the default behavior explicitly in the SP header comment, or add a parameter default (DEFAULT 1) at the parameter declaration level for clarity.","Add a covering index on POST_InboxDelivery (InboxDeliveryID) INCLUDE (ReadDate) if absent, to avoid table scans when updating large batches.","Guard against no-op writes by adding a WHERE condition that skips rows already in the target state (e.g., WHERE ReadDate IS NULL AND @effective_read = 1 OR ReadDate IS NOT NULL AND @effective_read = 0), reducing unnecessary transaction log activity."],"migrationRelevance":"medium"}]}