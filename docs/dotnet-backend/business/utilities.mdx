---
sidebar_position: 18
title: Business.Utilities
description: Cross-cutting utility services including email delivery, Excel generation, encryption, SMS, and request rate limiting used throughout the Business layer.
---
import DependentsPanel from '@site/src/components/DependentsPanel';

# Business.Utilities

The `Business.Utilities` module provides reusable utility services consumed by multiple Business layer modules. Unlike `Business.Common` (which provides infrastructure for Manager classes), Utilities offers concrete service implementations: outbound email via `EmailUtility`, Excel report generation via `ExcelProcess`, encryption key management via `EncryptKeyGen`, SMS messaging via `TelnyxSmsService`, HTTP persistence helpers via `PersistComponent`, and API rate limiting via `RequestRateLimiter`.

These utilities are stateless service classes — they expose static or instance methods and have no module-specific business logic, making them safely reusable across Security, Mail, Evaluations, and other modules.

## Key Classes

| Class | Lines | Purpose |
|-------|-------|---------|
| `EmailUtility` | ~180 | Outbound email construction and delivery via Mailgun SMTP/API. Handles HTML templates, attachments, bounce tracking, and retry logic. |
| `ExcelProcess` | ~220 | Excel workbook generation using EPPlus. Produces formatted spreadsheets for evaluation results, duty hour exports, CME transcripts, and roster reports. |
| `EncryptKeyGen` | ~90 | Symmetric encryption and decryption for sensitive fields (SSNs, API keys, patient identifiers) stored in the database. |
| `PersistComponent` | ~75 | HTTP session and ViewState persistence helpers for multi-step wizard workflows (evaluation setup, import processes). |
| `TelnyxSmsService` | ~110 | SMS message delivery via Telnyx API. Used for MFA codes, duty hour violation alerts, and urgent notifications. |
| `RequestRateLimiter` | ~85 | In-memory rate limiting for API endpoints and scheduler invocations. Prevents runaway loops and protects third-party API quotas. |

{/* DEPENDENTS-PANEL:START */}
<DependentsPanel
  module="Utilities"
  webDependents={[
  {
    "fileName": "CMEEvaluationDetailsForAudittrail.aspx.cs",
    "filePath": "Web/CMETracking/CMEEvaluationDetailsForAudittrail.aspx.cs",
    "directory": "Web/CMETracking",
    "module": "CMETracking"
  },
  {
    "fileName": "DeclineCMEEvaluation.aspx.cs",
    "filePath": "Web/CMETracking/DeclineCMEEvaluation.aspx.cs",
    "directory": "Web/CMETracking",
    "module": "CMETracking"
  },
  {
    "fileName": "ForgotPassword.aspx.cs",
    "filePath": "Web/CommercialNew/ForgotPassword.aspx.cs",
    "directory": "Web/CommercialNew",
    "module": "CommercialNew"
  },
  {
    "fileName": "ConferenceAttendanceImporting.aspx.cs",
    "filePath": "Web/DutyHours/ConferencesAndClinics/ConferenceAttendanceImporting.aspx.cs",
    "directory": "Web/DutyHours",
    "module": "DutyHours"
  },
  {
    "fileName": "ConferenceImporting.aspx.cs",
    "filePath": "Web/DutyHours/ConferencesAndClinics/ConferenceImporting.aspx.cs",
    "directory": "Web/DutyHours",
    "module": "DutyHours"
  },
  {
    "fileName": "DeclineConferenceEvaluation.aspx.cs",
    "filePath": "Web/DutyHours/ConferencesAndClinics/DeclineConferenceEvaluation.aspx.cs",
    "directory": "Web/DutyHours",
    "module": "DutyHours"
  },
  {
    "fileName": "DHUserVerificationAuto.aspx.cs",
    "filePath": "Web/DutyHours/DHUserVerificationAuto.aspx.cs",
    "directory": "Web/DutyHours",
    "module": "DutyHours"
  },
  {
    "fileName": "ManageCorePersonnel.aspx.cs",
    "filePath": "Web/Evaluations/ManageCorePersonnel.aspx.cs",
    "directory": "Web/Evaluations",
    "module": "Evaluations"
  },
  {
    "fileName": "MileStoneCommitteeMemberDelete.aspx.cs",
    "filePath": "Web/Evaluations/MileStoneCommitteeMemberDelete.aspx.cs",
    "directory": "Web/Evaluations",
    "module": "Evaluations"
  },
  {
    "fileName": "EncryptKeyGen.aspx.cs",
    "filePath": "Web/Security/EncryptKeyGen.aspx.cs",
    "directory": "Web/Security",
    "module": "Security"
  },
  {
    "fileName": "UserMerger.aspx.cs",
    "filePath": "Web/Security/UserMerger.aspx.cs",
    "directory": "Web/Security",
    "module": "Security"
  },
  {
    "fileName": "UserMove.aspx.cs",
    "filePath": "Web/Security/UserMove.aspx.cs",
    "directory": "Web/Security",
    "module": "Security"
  },
  {
    "fileName": "Demo.aspx.cs",
    "filePath": "Web/Demo.aspx.cs",
    "directory": "Web",
    "module": "Marketing"
  },
  {
    "fileName": "ForgotPassword.aspx.cs",
    "filePath": "Web/ForgotPassword.aspx.cs",
    "directory": "Web",
    "module": "Authentication"
  },
  {
    "fileName": "Home.aspx.cs",
    "filePath": "Web/Home.aspx.cs",
    "directory": "Web",
    "module": "Authentication"
  },
  {
    "fileName": "Login.aspx.cs",
    "filePath": "Web/Login.aspx.cs",
    "directory": "Web",
    "module": "Authentication"
  },
  {
    "fileName": "MasterPage.master.cs",
    "filePath": "Web/MasterPage.master.cs",
    "directory": "Web",
    "module": "Layout"
  },
  {
    "fileName": "PasswordChangeNew.aspx.cs",
    "filePath": "Web/PasswordChangeNew.aspx.cs",
    "directory": "Web",
    "module": "Authentication"
  },
  {
    "fileName": "TestWebService.aspx.cs",
    "filePath": "Web/TestWebService.aspx.cs",
    "directory": "Web",
    "module": "Developer Tools"
  },
  {
    "fileName": "acgme2023.aspx.cs",
    "filePath": "Web/acgme2023.aspx.cs",
    "directory": "Web",
    "module": "Conference/Event Registration"
  },
  {
    "fileName": "medcomreg.aspx.cs",
    "filePath": "Web/medcomreg.aspx.cs",
    "directory": "Web",
    "module": "User Registration"
  }
]}
  schedulerDependents={[
  {
    "fileName": "Reminder.cs",
    "filePath": "Schedulers/APEReminder/APEReminder/APEReminder/Reminder.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "EmailSender.cs",
    "filePath": "Schedulers/FNPDeleteDroppedCourseEvaluation/FNPDeleteDroppedCourseEvaluation/EmailSender.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "EmailSender.cs",
    "filePath": "Schedulers/FNPStudentLogReview/FNPStudentLogReview/EmailSender.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "InboxReminder.cs",
    "filePath": "Schedulers/InboxReminder/InboxReminder/InboxReminder.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "LiabilityInsReminder.cs",
    "filePath": "Schedulers/LiabilityInsReminder-Dotnet/LiabilityInsReminder.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "License.cs",
    "filePath": "Schedulers/LicenseReminders/LicenseReminders/LicenseReminders/License.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "MailDistribution.cs",
    "filePath": "Schedulers/MailDistribution-Dotnet/MailDistribution.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "MailBounceLog.cs",
    "filePath": "Schedulers/MailgunService/MailgunWebhookService/MailBounceLog.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "MidtermAndFinalEvaluationRemBusiness.cs",
    "filePath": "Schedulers/MidtermFinalEvaluationReminderFacultyPrecep/MidtermFinalEvaluationReminderFacultyPrecep/MidtermAndFinalEvaluationRemBusiness.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "OnCallBusiness.cs",
    "filePath": "Schedulers/OnCallAutoAssignment-Dotnet/OnCallAutoAssignment-Dotnet/OnCallBusiness.cs",
    "directory": "Schedulers"
  },
  {
    "fileName": "RequirementGroupAssignmentReminder.cs",
    "filePath": "Schedulers/OnboardingAssignmentReminder/OnboardingAssignmentReminder/OnboardingAssignmentReminder/RequirementGroupAssignmentReminder.cs",
    "directory": "Schedulers"
  }
]}
/>
{/* DEPENDENTS-PANEL:END */}

## File Reference

- [**Business.Utilities Implementation Files**](./files/utilities) — 18 classes with per-file summaries, key methods, stored procedures, and migration notes
